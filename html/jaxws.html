<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Bare JAX-WS</title><link href="main.css" type="text/css" rel="stylesheet"><meta content="DocBook XSL Stylesheets V1.77.1" name="generator"><meta name="description" content="This document is incomplete; it is made available for review purposes only. This document is a member of the Bare Series of WAS topics distributed in both stand-alone and in collection form."><style type="text/css">
body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><div><h1 class="title"><a name="N10001"></a>Bare JAX-WS</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Paul</span> <span class="surname">Glezen</span></h3><div class="affiliation"><span class="jobtitle">IT Specialist<br></span><span class="orgname">IBM<br></span> <span class="orgdiv">Software Services for WebSphere<br></span></div></div></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
        This document is incomplete; it is made available for
        review purposes only.
      </p><p>
        This document is a member of the Bare Series of WAS
        topics distributed in both stand-alone and in collection form.
      </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="#sec.chap1">1. Bare JAX-WS Web Services</a></span></dt><dd><dl><dt><span class="section"><a href="#sec.jaxws.clients">1.1. JAX-WS Clients</a></span></dt></dl></dd><dt><span class="section"><a href="#sec.listings">2. Source Listings</a></span></dt><dd><dl><dt><span class="section"><a href="#sec.listings.ccQuery.wsdl">2.1. <code class="filename">ccQuery.wsdl</code></a></span></dt></dl></dd><dt><span class="section"><a href="#N100ED">3. References</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec.chap1"></a>1.&nbsp;Bare JAX-WS Web Services</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec.jaxws.clients"></a>1.1.&nbsp;JAX-WS Clients</h3></div></div></div><p>
<span class="bold"><strong>J</strong></span>ava 
<span class="bold"><strong>A</strong></span>PI for 
<span class="bold"><strong>X</strong></span>ML - 
<span class="bold"><strong>W</strong></span>eb 
<span class="bold"><strong>S</strong></span>ervices 
(JAX-WS) is a specification that addresses
Java web services development.  For web service clients, this amounts to
generating Java client service stubs and XML bindings for use in invoking
the web service.  <a class="xref" href="#fig.jaxws.client.overview" title="Figure&nbsp;1.&nbsp;JAX-WS Overview">Figure&nbsp;1</a> illustrates how
these components fit together.  The green and yellow components
are generated from the WSDL.  The green is the service stub.  Its objects
make the remote call to the service provider.  The yellow represents
the XML-type-to-Java-type bindings (or simply XML bindings).  The XML
bindings are actually addressed by a separate specification called
<span class="bold"><strong>J</strong></span>ava
<span class="bold"><strong>A</strong></span>PI for
<span class="bold"><strong>X</strong></span>ML
<span class="bold"><strong>B</strong></span>indings
(JAXB) that is referenced by JAX-WS.  This is part of what makes JAX-WS
so much more powerful than its predecessor,
<span class="bold"><strong>J</strong></span>ava 
<span class="bold"><strong>A</strong></span>PI for 
<span class="bold"><strong>X</strong></span>ML - 
<span class="bold"><strong>R</strong></span>emote 
<span class="bold"><strong>P</strong></span>rocedure
<span class="bold"><strong>C</strong></span>all
(JAX-RPC).

</p><div class="figure"><a name="fig.jaxws.client.overview"></a><p class="title"><b>Figure&nbsp;1.&nbsp;JAX-WS Overview</b></p><div class="figure-contents"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="70%"><tr><td><img src="images/jaxwsOverview.jpg" width="100%" alt="JAX-WS Overview"></td></tr></table></div></div></div><br class="figure-break"><p>
Another recent improvement is the inclusion of the JAX-WS runtime in the
Java 6 SE (standard edition).  One no longer needs to reference special
"thin client" libraries to make web service clients run.  The generated
bindings run directly against a Java 6 or later runtime.  And not only
are the runtime classes available in the JRE, the 
<em class="firstterm">wsimport</em> utility, responsible for generating
the bindings from the WSDL, is
part of the JDK on any platform.  No special IDEs or tools are needed.
</p><p>
The XML bindings are Java classes that map to the XML schema types defined
in the WSDL.  (One says that a Java type is bound to the XML schema type.)
These types play the role of parameters for the service invocation.  The
invocation functions themselves are methods on the service stub objects.
The bindings objects are passed as parameters to the service objects.
</p><p>
The generated service and binding objects tie into the JAX-WS runtime.
This may be part of the JDK as in the diagram above.  Or it may be implemented
by a vendor such as Apache CXF or IBM WebSphere Application Server.  In any
case, it is responsible for 
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">marshaling the data structures into a serialized XML stream, and</li><li class="listitem">implementing the network protocol to transport the XML stream
     to the server.</li></ul></div><p>
Finally, the client code is the consumer of the service.  It issues the request
to the service stub and does whatever it requires with the result.
</p><p>
Web service clients may be <em class="firstterm">managed</em> or 
<em class="firstterm">unmanaged</em>.  Managed clients are typically associated with
an application server.  The client is managed in the sense that aspects of its
configuration are controllable through the administrative capabilities of the
application server.  References to the service stub objects are usually 
retrieved from JNDI.

Unmanaged clients, also known as <em class="firstterm">thin clients</em>, do not rely
on any underlying application server structure for configuration.  Their service
client proxy objects are directly instantiated. Their configuration is usually
done by setting properties on the service stub instances.  There is nothing wrong
with running a thin client inside an application server.  It simply won't benefit
from enterprise manageability features.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="sec.jaxws.clients.thin"></a>1.1.1.&nbsp;Thin Clients</h4></div></div></div></div><p>
A thin client is one that does not expect the presense of any application
server infrastructure.  That's not to say a thin client can't run within
an application server container.  It simply doesn't depend on the container
for resources or initialization.
</p><p>
Generating a thin client is easy and requires nothing more than a valid WSDL
and JDK 6.  The command for generating the JAX-WS bindings is
<span class="bold"><strong>wsimport</strong></span>.  It should be in your command
line path so long as your JDK is.  To verify its version and presence in
your path, query its version.
</p><pre class="screen">$ wsimport -version
JAX-WS RI 2.1.6 in JDK 6
$
</pre><p>
We'll use the WSDL listed in <a class="xref" href="#sec.listings.ccQuery.wsdl" title="2.1.&nbsp;ccQuery.wsdl">Section&nbsp;2.1</a>.
It's a standalone WSDL file with a single operation that queries
information about a credit card account.  Let's start with the following
invocation of wsimport.
</p><pre class="screen">thinclient$ wsimport -d bin -s src -p org.acme.cc.jaxws ccQuery.wsdl
parsing WSDL...
generating code...
compiling code...
thinclient$
</pre><p>
The options have the following meanings.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="option">-d</code> directory into which the compiled class files are placed</li><li class="listitem"><code class="option">-s</code> directory into which the source code is generated</li><li class="listitem"><code class="option">-p</code> package into which the source code is generated</li></ul></div><p>
If you run this command without first creating the <code class="filename">bin</code> 
and <code class="filename">src</code> directories, the command will give an error.
Otherwise you get the following generated bindings classes.

</p><pre class="screen">thinclient/src/org/acme/cc/jaxws$ ls -l
total 64
-rw-r--r--  1 pglezen  staff  1073 Jun 16 13:42 CCPortType.java
-rw-r--r--  1 pglezen  staff  2341 Jun 16 13:42 CCService.java
-rw-r--r--  1 pglezen  staff  1363 Jun 16 13:42 ObjectFactory.java
-rw-r--r--  1 pglezen  staff  1813 Jun 16 13:42 QueryFault.java
-rw-r--r--  1 pglezen  staff  1053 Jun 16 13:42 QueryFaultMsg.java
-rw-r--r--  1 pglezen  staff  2061 Jun 16 13:42 QueryRequest.java
-rw-r--r--  1 pglezen  staff  3727 Jun 16 13:42 QueryResponse.java
-rw-r--r--  1 pglezen  staff   108 Jun 16 13:42 package-info.java
thinclient/src/org/acme/cc/jaxws$ 
</pre><p>

The problem with this generation of bindings concerns the
<code class="classname">CCService</code> class.  It needs to find a copy of the WSDL and
without any additional arguments to <span class="command"><strong>wsimport</strong></span>, it uses the
fully-qualified path name to the from which the bindings were generated.

</p><pre class="programlisting">URL baseUrl;
baseUrl = org.acme.cc.jaxws.CCService.class.getResource(".");
url = new URL(baseUrl, "file:/Users/pglezen/thinclient/ccQuery.wsdl");
</pre><p>

Clearly we don't want code referencing an absolute path on a developer's
workstation.  We provide information to <span class="command"><strong>wsimport</strong></span> via
the <code class="option">-wsdllocation</code>.  From the code snippet above, 
one can see that the base
of the URL begins with the package directory of the class itself.
The WSDL will be found if we add it to the directory holding
<code class="filename">CCService.java</code>.

</p><pre class="screen">thinclient$ wsimport -d bin -s src -p org.acme.cc.jaxws -wsdllocation ccQuery.wsdl ccQuery.wsdl
</pre><p>

This results in the following snippet in <code class="filename">CCService.java</code>.

</p><pre class="programlisting">URL baseUrl;
baseUrl = org.acme.cc.jaxws.CCService.class.getResource(".");
url = new URL(baseUrl, "ccQuery.wsdl");
</pre><p>

</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec.listings"></a>2.&nbsp;Source Listings</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sec.listings.ccQuery.wsdl"></a>2.1.&nbsp;<code class="filename">ccQuery.wsdl</code></h3></div></div></div><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsdl:definitions targetNamespace="urn:issw:bare:wssec:cc:query" 
                        xmlns:tns="urn:issw:bare:wssec:cc:query" 
                        xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
                        xmlns:wsdlsoap="http://schemas.xmlsoap.org/wsdl/soap/" 
                        xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;wsdl:types&gt;
    &lt;schema targetNamespace="urn:issw:bare:wssec:cc:query" 
            xmlns="http://www.w3.org/2001/XMLSchema"&gt;
      &lt;element name="QueryRequest"&gt;
        &lt;complexType&gt;
          &lt;sequence&gt;
            &lt;element name="ccNo"     type="xsd:string"/&gt;
            &lt;element name="lastName" type="xsd:string"/&gt;
          &lt;/sequence&gt;
        &lt;/complexType&gt;
      &lt;/element&gt;
      &lt;element name="QueryResponse"&gt;
        &lt;complexType&gt;
          &lt;sequence&gt;
            &lt;element name="ccNo"      type="string"/&gt;
            &lt;element name="acctNo"    type="string"/&gt;
            &lt;element name="lastName"  type="string"/&gt;
            &lt;element name="firstName" type="string"/&gt;
            &lt;element name="balance"   type="int"/&gt;
          &lt;/sequence&gt;
        &lt;/complexType&gt;
      &lt;/element&gt;
      &lt;element name="QueryFault"&gt;
        &lt;complexType&gt;
          &lt;sequence&gt;
            &lt;element name="ccNo"  type="string"/&gt;
            &lt;element name="txnId" type="int"/&gt;
          &lt;/sequence&gt;
        &lt;/complexType&gt;
      &lt;/element&gt;
    &lt;/schema&gt;
  &lt;/wsdl:types&gt;

  &lt;wsdl:message name="QueryRequestMsg"&gt;
    &lt;wsdl:part element="tns:QueryRequest" name="parameters"/&gt;
  &lt;/wsdl:message&gt;

  &lt;wsdl:message name="QueryResponseMsg"&gt;
    &lt;wsdl:part element="tns:QueryResponse" name="parameters"/&gt;
  &lt;/wsdl:message&gt;

  &lt;wsdl:message name="QueryFaultMsg"&gt;
    &lt;wsdl:part element="tns:QueryFault" name="parameters"/&gt;
  &lt;/wsdl:message&gt;

  &lt;wsdl:portType name="CCPortType"&gt;
    &lt;wsdl:operation name="query"&gt;
       &lt;wsdl:input  message="tns:QueryRequestMsg"  name="queryRequest"/&gt;
       &lt;wsdl:output message="tns:QueryResponseMsg" name="queryResponse"/&gt;
       &lt;wsdl:fault  message="tns:QueryFaultMsg"    name="queryFault"/&gt;
    &lt;/wsdl:operation&gt;
  &lt;/wsdl:portType&gt;

  &lt;wsdl:binding name="CCSoapBinding" type="tns:CCPortType"&gt;
    &lt;wsdlsoap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/&gt;
    &lt;wsdl:operation name="query"&gt;
      &lt;wsdlsoap:operation soapAction="ccQuery" style="document"/&gt;

      &lt;wsdl:input name="queryRequest"&gt;
        &lt;wsdlsoap:body use="literal"/&gt;
      &lt;/wsdl:input&gt;

      &lt;wsdl:output name="queryResponse"&gt;
        &lt;wsdlsoap:body use="literal"/&gt;
      &lt;/wsdl:output&gt;

      &lt;wsdl:fault name="queryFault"&gt;
        &lt;wsdlsoap:fault name="queryFault" use="literal"/&gt;
      &lt;/wsdl:fault&gt;
    &lt;/wsdl:operation&gt;
  &lt;/wsdl:binding&gt;

  &lt;wsdl:service name="CCService"&gt;
    &lt;wsdl:port binding="tns:CCSoapBinding" name="CCService"&gt;
      &lt;wsdlsoap:address location="http://localhost/services/statement"/&gt;
    &lt;/wsdl:port&gt;
  &lt;/wsdl:service&gt;
&lt;/wsdl:definitions&gt;
</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N100ED"></a>3.&nbsp;References</h2></div></div></div><div class="bibliolist"><div class="bibliomixed"><a name="ref.WASInfoCenter"></a><p class="bibliomixed">[1] 
    <span class="title">WAS 8.0 Info Center</span>,
    <span class="author"><span class="orgname">IBM</span></span>.
    Online: 
    <a class="link" href="http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/" target="_top">http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/</a>
  </p></div><div class="bibliomixed"><a name="ref.WSSecSpec1.2"></a><p class="bibliomixed">[2] 
    <span class="title">WS-SecurityPolicy 1.2 Specification</span>,
    <span class="date">December, 2006</span>. 
    <span class="author"><span class="orgname">OASIS</span></span>.
    Online: 
    <a class="link" href="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200512" target="_top">http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200512</a>
  </p></div><div class="bibliomixed"><a name="ref.redpaper.wsApps"></a><p class="bibliomixed">[3] 
    <span class="title">Developing Web Service Applications</span>,
    <span class="author"><span class="orgname">IBM</span></span>.
    Red Paper Online:
    <a class="link" href="http://www.redbooks.ibm.com/redpapers/pdfs/redp4884.pdf" target="_top">http://www.redbooks.ibm.com/redpapers/pdfs/redp4884.pdf</a>
  </p></div></div></div></div></body></html>